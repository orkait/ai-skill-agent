User: Refactor this component to remove prop drilling and improve boundaries, preserving behavior.

Expected behavior:
- Classify as Refactor
- Require/introduce characterization tests first if behavior is not test-locked
- Apply composition patterns / context injection (not state) as needed
- Preserve public API unless explicitly allowed to change
